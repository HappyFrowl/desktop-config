---
- hosts: localhost
  connection: local
  become: true

  tasks:
  - name: copy .bashrc file
    copy:
      src: files/bashrc
      dest: /home/filip/.bashrc
      owner: filip
      group: filip

  - name: copy sources.list
    copy:
      src: files/sources.list
      dest: /etc/apt/sources.list
      owner: root
      group: root

  - name: Add brave browser repository key
    become: true
    shell: curl -fsSLo /usr/share/keyrings/brave-browser-archive-keyring.gpg https://brave-browser-apt-release.s3.brave.com/brave-browser-archive-keyring.gpg

  - name: copy brave repo file
    copy:
      src: files/brave-browser-release.list
      dest: /etc/apt/sources.list.d/brave-browser-release.list
      owner: filip
      group: filip

  - name: update apt cache
    become: true
    apt:
      update_cache: yes

  - name: install brave browser
    become: true
    apt:
      name: brave-browser
      state: present

  - name: install spotify
    become: true
    community.general.snap:
      name: spotify
      state: present

  - name: install
    community.general.snap:
      name: "{{ item.name }}"
      classic: "{{ item.classic| default(false) }}"
      state: present
    loop:
      - name: whatsdesk
      - name: powershell
        classic: true
      - name: code
        classic: true

  - name: copy snap packages to /usr/share
    copy:
     remote_src: /var/lib/snapd/desktop/application/*.desktop
     dest: /usr/share/applications/
     owner: root
     group: root
    remote_src: true

  - name: install packages
    package:
      name: "{{ item }}"
      state: present
    loop:
      - htop
      - curl
      - python3-psutil
      - vlc
      - qbittorrent
      - nvidia-driver
      - snapd
      - timeshift
      - ksystemlog
      - teamviewer
      - zsh
      - flatpak
